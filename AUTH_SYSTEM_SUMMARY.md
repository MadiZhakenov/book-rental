# ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ JWT - –ì–û–¢–û–í–û

## –°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

## Backend (apps/api)

### 1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
@nestjs/passport
passport
passport-jwt
@nestjs/jwt
bcrypt
@types/passport-jwt
@types/bcrypt
```

### 2. Auth Module
**–§–∞–π–ª—ã**:
- `src/auth/auth.module.ts` - –º–æ–¥—É–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `src/auth/auth.service.ts` - —Å–µ—Ä–≤–∏—Å —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π
- `src/auth/auth.controller.ts` - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å endpoints
- `src/auth/jwt.strategy.ts` - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è JWT
- `src/auth/dto/register.dto.ts` - DTO –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `src/auth/dto/login.dto.ts` - DTO –¥–ª—è –≤—Ö–æ–¥–∞

### 3. API Endpoints

#### POST `/auth/register`
**Body**:
```json
{
  "email": "user@example.com",
  "password": "password123",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
}
```
**Response**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### POST `/auth/login`
**Body**:
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```
**Response**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### GET `/auth/me` (Protected)
**Headers**:
```
Authorization: Bearer <access_token>
```
**Response**:
```json
{
  "id": "uuid",
  "email": "user@example.com",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "isPremium": false,
  "booksCount": 3,
  "rating": 4.5,
  "createdAt": "2025-12-10T12:00:00.000Z"
}
```

---

## Frontend (apps/web)

### 1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
react-hook-form
zod
@hookform/resolvers
js-cookie
@types/js-cookie
axios
```

### 2. API Client
**–§–∞–π–ª**: `lib/api.ts`
- Axios instance —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º JWT —Ç–æ–∫–µ–Ω–∞
- –ú–µ—Ç–æ–¥—ã: `register()`, `login()`, `getMe()`
- –£—Ç–∏–ª–∏—Ç—ã: `setAuthToken()`, `removeAuthToken()`, `getAuthToken()`

### 3. UI Components (Shadcn)
- `components/ui/input.tsx` - –ø–æ–ª–µ –≤–≤–æ–¥–∞
- `components/ui/card.tsx` - –∫–∞—Ä—Ç–æ—á–∫–∞
- `components/ui/label.tsx` - –ª–µ–π–±–ª

### 4. –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

#### –†—É—Å—Å–∫–∏–µ –≤–µ—Ä—Å–∏–∏:
- `/ru/auth/login` - –≤—Ö–æ–¥
- `/ru/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `/ru/profile` - –ø—Ä–æ—Ñ–∏–ª—å (–∑–∞—â–∏—â–µ–Ω–Ω–∞—è)

#### –ö–∞–∑–∞—Ö—Å–∫–∏–µ –≤–µ—Ä—Å–∏–∏:
- `/kk/auth/login` - –≤—Ö–æ–¥
- `/kk/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `/kk/profile` - –ø—Ä–æ—Ñ–∏–ª—å (–∑–∞—â–∏—â–µ–Ω–Ω–∞—è)

### 5. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ—Ñ–∏–ª—è

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è**:
- ‚úÖ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ Email
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥
- ‚úÖ –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ (–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π / Premium)
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ª–∏–º–∏—Ç–∞ –∫–Ω–∏–≥ (X/5 –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö)
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å Premium" (–¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö)
- ‚úÖ –¢–µ–∫—Å—Ç "–ë–µ–∑–ª–∏–º–∏—Ç" (–¥–ª—è Premium)
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏"

**–õ–æ–≥–∏–∫–∞**:
- –ï—Å–ª–∏ `isPremium === false`: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å `{booksCount}/5 –∫–Ω–∏–≥` —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
- –ï—Å–ª–∏ `isPremium === true`: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "Premium (–ë–µ–∑–ª–∏–º–∏—Ç)"
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ (5 –∫–Ω–∏–≥) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞–≤–±–∞—Ä—ã
**–§–∞–π–ª—ã**:
- `components/navbar-ru.tsx` - —Ä—É—Å—Å–∫–∏–π –Ω–∞–≤–±–∞—Ä
- `components/navbar-kk.tsx` - –∫–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞–≤–±–∞—Ä

**–õ–æ–≥–∏–∫–∞**:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ "–í–æ–π—Ç–∏" –∏ "–ù–∞—á–∞—Ç—å"
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–ü—Ä–æ—Ñ–∏–ª—å" —Å –∏–∫–æ–Ω–∫–æ–π

### 7. –ü–µ—Ä–µ–≤–æ–¥—ã
–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–≤–æ–¥—ã –≤ `messages/ru.json` –∏ `messages/kk.json`:
- –§–æ—Ä–º—ã –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è
- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤

**Backend**:
```bash
cd apps/api
npm run dev
# –ó–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://localhost:4000
```

**Frontend**:
```bash
cd apps/web
npm run dev
# –ó–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://localhost:3000
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000/ru/auth/register`
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É (–∏–º—è, email, –ø–∞—Ä–æ–ª—å)
3. –ù–∞–∂–º–∏—Ç–µ "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"
4. –í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ `/ru/profile`

#### –í—Ö–æ–¥:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000/ru/auth/login`
2. –í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å
3. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
4. –í—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ `/ru/profile`

#### –ü—Ä–æ—Ñ–∏–ª—å:
1. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ `/ru/profile`
2. –£–≤–∏–¥–∏—Ç–µ:
   - –í–∞—à–µ –∏–º—è –∏ email
   - –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
   - –ü—Ä–æ–≥—Ä–µ—Å—Å –ª–∏–º–∏—Ç–∞ –∫–Ω–∏–≥ (–µ—Å–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ)
   - –ö–Ω–æ–ø–∫—É "–ö—É–ø–∏—Ç—å Premium" (–µ—Å–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
3. –ù–∞–∂–º–∏—Ç–µ "–í—ã–π—Ç–∏" –¥–ª—è –≤—ã—Ö–æ–¥–∞

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤

–ß—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å freemium –º–æ–¥–µ–ª—å:
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
2. –°–æ–∑–¥–∞–π—Ç–µ 5 –∫–Ω–∏–≥ —á–µ—Ä–µ–∑ API
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å 6-—é –∫–Ω–∏–≥—É
4. –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ—à–∏–±–∫–∞: "–õ–∏–º–∏—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏—Å—á–µ—Ä–ø–∞–Ω"

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt (10 —Ä–∞—É–Ω–¥–æ–≤)
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π
- ‚úÖ Protected routes —Å `@UseGuards(AuthGuard('jwt'))`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é class-validator
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ —Å –ø–æ–º–æ—â—å—é zod

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –í production –∑–∞–º–µ–Ω–∏—Ç–µ `JWT_SECRET` –≤ `.env`:
```env
JWT_SECRET=your-super-secret-key-here
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. **Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è**: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª "–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?"
3. **Refresh tokens**: –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
4. **OAuth**: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google/Facebook
5. **2FA**: –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
6. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫—É–ø–∫–∏ Premium**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π

---

## ‚ú® –ò—Ç–æ–≥

**–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã**:
- ‚úÖ Backend: Auth Module —Å JWT
- ‚úÖ Endpoints: register, login, getMe
- ‚úÖ Frontend: –°—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è: RU –∏ KK –≤–µ—Ä—Å–∏–∏
- ‚úÖ UI: –§–æ—Ä–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –ù–∞–≤–±–∞—Ä—ã: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å: –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º

**–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
